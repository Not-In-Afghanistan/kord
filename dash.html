<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KORD Dashboard</title>
<link rel="stylesheet" href="./Style/chat.css">
<link rel="icon" type="image/ico" href="./images/favicon.ico">
</head>
<body>

<!-- Servers sidebar -->
<div id="servers">
  <h3>Servers</h3>
  <button id="add-server-btn" class="addServerBtn">Add Server</button>
  <button id="join-server-btn">Join Server</button>
  <ul id="server-list">
    <!-- Joined servers appear here s -->
  </ul>
</div>

<!-- Friends sidebar -->
<div id="friends">
  <h3>Friends</h3>
  <header>
    <h3>Welcome, <span id="displayName"></span> !</h3>
  </header>
  <ul id="friend-list">
    <!-- Friend list goes here -->
  </ul>
</div>

<!-- Main chat area -->
<div id="main">
  <div id="messages"></div>
  <form id="chat-form">
    <input type="text" id="chat-input" placeholder="Type a message..." required />
    <button type="submit">Send</button>
  </form>
</div>

<!-- Add Server Modal -->
<div id="server-modal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Create Server</h2>
    <input type="text" id="server-name" placeholder="Server Name" required>
    <input type="file" id="server-image" accept="image/*">
    <input type="password" id="server-password" placeholder="Server Password">
    <button id="create-server">Create Server</button>
  </div>
</div>

<!-- Join Server Modal -->
<div id="join-modal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Join Server</h2>
    <input type="text" id="join-server-name" placeholder="Server Name" required>
    <input type="password" id="join-server-password" placeholder="Server Password">
    <button id="join-server-confirm">Join Server</button>
  </div>
</div>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<!-- Firebase Config -->
<script>
const firebaseConfig = {
  apiKey: "AIzaSyBGPFSP0e0oYqKqvJHLB5eGlX9mJ8aU09s",
  authDomain: "test-da143.firebaseapp.com",
  databaseURL: "https://test-da143-default-rtdb.firebaseio.com",
  projectId: "test-da143",
  storageBucket: "test-da143.appspot.com",
  messagingSenderId: "58366480447",
  appId: "1:58366480447:web:f3dd12850f09952b49688a",
  measurementId: "G-T5HK7JTWHW"
};
firebase.initializeApp(firebaseConfig);
</script>

<!-- Dashboard Scripts -->
<script src="./script/chat.js" defer></script>
<script>
window.addEventListener("DOMContentLoaded", () => {
  const displayNameEl = document.getElementById("displayName");
  const username = localStorage.getItem("currentUser") || "Guest";
  const userRole = localStorage.getItem("role") || "user";
  displayNameEl.textContent = username;

  // Enable/disable Add Server button based on role
  const addServerBtn = document.getElementById("add-server-btn");
  if (userRole !== "premium" && userRole !== "admin") {
    addServerBtn.disabled = true;
    addServerBtn.title = "Premium only: Upgrade to add servers";
  } else {
    addServerBtn.disabled = false;
    addServerBtn.title = "";
  }

  addServerBtn.onclick = () => {
    if (userRole === "premium" || userRole === "admin") {
      openServerModal();
    }
  };

  // Modal close buttons
  document.querySelectorAll(".modal .close").forEach(btn => {
    btn.onclick = () => btn.closest(".modal").style.display = "none";
  });

  // Close modal on click outside
  window.onclick = e => {
    document.querySelectorAll(".modal").forEach(modal => {
      if (e.target === modal) modal.style.display = "none";
    });
  };
});
</script>
</body>
</html>
